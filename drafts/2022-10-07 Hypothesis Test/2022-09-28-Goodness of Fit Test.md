Goodness of Fit Test

# Introduction

拟合优度检验问题，已在XX中说明过：

设有一个可观察的、一维或多维随机变量$X$。$X_1,\cdots, X_n$是$X$的独立观察值，$F$是一个***已知的* 分布函数**（下面会提到，分为“理论分布完全已知”和“理论分布带参数”两种情况），其维度与$X$的维度相同。要利用样本$X_1,\cdots,X_n$去检验假设：
$$
\mathrm{H:X的分布为F}\label{hypothesis}
$$
或者这样提：如果用分布$F$去拟合样本$X_1,\cdots,X_n$，则拟合的优良程度如何？

$F$通常称为理论分布。
{: .notice--primary}

拟合优度检验方法处理这种问题的一般原则是：**设法确定**一个量$D(X_1,\cdots,X_n;F)$，它**有某种理由可以**作为样本$X_1,\cdots, X_n$与$F$的偏离的度量。就具体样本算出$D$的值，记为$D_0$。然后在假设$H$成立的条件下算出概率：
$$
p(D_0)=P(D\ge D_0\vert D)\notag
$$
它称为在**选定的偏离指标**$D$之下样本与理论分布的**拟合优度**。$P(D_0)$越大，表示样本与理论分布的拟合越好，因而假设$\eqref{hypothesis}$越可信，

一般地，事先根据某种考虑，给定一个介于0与1之间的阈值$\alpha$（通常很小），然后：
$$
\begin{split}
&当p(D_0)<\alpha时否定H\\
&当p(D_0)\ge\alpha时接受H\\
\end{split}\notag
$$
这种类型的检验通常称为拟合优度检验。由于偏离指标$D$可以用种种不同的方法定义，因而可以有种种不同的拟合优度检验。其中最著名的时K. Pearson在1900年提出的$\chi^2$检验和==XXX==在1933年提出的一种检验。

<br>

# Pearson $\chi^2$ 检验

## 理论分布完全已知

### 离散型

设$X$只取有限个不同的值$a_1,\cdots,a_r$。理论分布$F$集中在$a_i$点的概率记作$p_i$，则假设$\eqref{hypothesis}$可以写为：
$$
H:\ P(X=a_i)=p_i\quad(i=1,2,\cdots,r)
$$
其中，$p_i>0$**已知**，且$\sum_{i=1}^rp_i=1$。

以$\nu_i$记$X_1,\cdots,X_n$中等于$a_i$的个数，$\nu_i$称为$a_i$的**观察频数**，且有$\sum_{i=1}^r\nu_i=n$。相对应地，$np_i$称为$a_i$的**理论频数**，意指当$X$的分布确为$F$时，“在理论上”应该取的值（事实上，这时有$E\nu_i=np_i$）。

K. Pearson引入如下的统计量（通常称为Pearson $\chi^2$统计量），以反映样本与理论分布之间的偏离：
$$
\kappa=\kappa(X_1,\cdots,X_n;F)=\sum_{i=1}^r\dfrac{(\nu_i-np_i)^2}{np_i}\label{eq1}
$$
==其直观背景是==

对一组样本算出$\kappa=\kappa_0$后，需要计算拟合优度$p(\kappa_0)=P(\kappa\ge\kappa_0\vert H)$。$\kappa$的真确分布很复杂（相当于计算统计量，即一个复杂的样本函数，式$\eqref{eq1}$的真确分布），故精确地计算$p(k_0)$不容易。

K. Pearson在其1900年地工作中证明了下面重要的定理：

定理1：若假设$H$为真，则当样本大小$n\rightarrow\infty$时，统计量$\kappa$的分布收敛于自由度为$r-1$的$\chi^2$分布，即$\chi^2_{r-1}$。
{: .notice--primary}

由此定理，当样本$n$较大时，可得$p(k_0)$的近似值为：
$$
p(k_0)\approx\Big[2^{(r-1)/2}\Gamma\big((r-1)/2\big)\Big]^{-1}\int_{k_{0}}^\infty e^{-(x/2)}x^{(r-3)/2}\mathrm{d}x
$$
该值可以在$\chi^2$分布表上查出，必要时进行插值。

==一般地，==

例：一家工厂分早、中、晚3班，每班3小时。近期发生了一些事故，怀疑班次不同与事故出现率是否有关。在记录地近期15次事故中，有6次在早班，3次在中班，6次在晚班。现要根据这一观测资料来做判断。

假设$H$：事故发生地可能性大小与班次无关。首先需要将这一陈述转化为一个概率命题。虚设一个变量$X$，取值分别为1，2，3，其意义是：若事故发生在早班，则$X=1$；若在中班发生，则$X=2$；若在晚班发生，则$X=3$。这样，上述假设$H$可以写作：
$$
P(X=i)=1/3\quad (i=1,2,3)\notag
$$
在本例中，$n=15$，$p_1=p_2=p_3=1/3$，$\nu_1=6$，$\nu_2=3$，$\nu_3=6$，则根据式$\eqref{eq1}$，可以计算出$\kappa_0$：
$$
\kappa_0=\dfrac15[(6-5)^2+(3-5)^2+(6-5)^2]=1.2\notag
$$


















使用`chiinv`函数
